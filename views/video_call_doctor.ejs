<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Vet-Lab</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="Favicon.ico" type="image/x-icon" rel="shortcut icon">
    <link rel="stylesheet" href="clinic/css/bootstrap.css">
    <link rel="stylesheet" href="clinic/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="clinic/css/animations.css">
    <link rel="stylesheet" href="clinic/css/dashboard-main.css">
    <link rel="stylesheet" href="clinic/css/dashboard.css">
    <link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
    <!--[if lt IE 9]>
    <script src="js/vendor/html5-3.6-respond-1.4.2.min.js"></script>
    <![endif]-->
    <script src="//media.twiliocdn.com/sdk/js/common/v0.1/twilio-common.min.js"></script>
    <script src="//media.twiliocdn.com/sdk/js/video/releases/1.0.0-beta2/twilio-video.js"></script>
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript" src="clinic/js/socket.io.js"></script>
    <script type="text/javascript" src="clinic/js/videocallDoctor.js"></script>

</head>

<body class="video-body">

    <div class="video-call">
        <div align="center" id="remote-media"
        class="embed-responsive embed-responsive-16by9 custom-height">
        
        <!--  <video autoplay loop class="embed-responsive-item" style="display:block ">
        <source src="clinic/img/video3.mp4" type="video/mp4">
        </video> -->


        <!-- <div class="video-image" style="display: none">
        <img src="clinic/img/profile_user.jpg" class="img-responsive center-block">
        <h1>Timothy</h1>
        <label>Connecting...</label>
    </div> -->
</div>

<div class="small-video" >
    <div align="center" class="embed-responsive embed-responsive-16by9" id="local-media">

    </div>
</div>
<div class="call-button">
    <ul class="call-ul">
        <li>
            <button type="button" class="cut" id="doctorCallCut"><i class="fa fa-phone" aria-hidden="true"></i></button>
        </li>
        <li>
            <button type="button" class="mute"><i class="fa fa-microphone-slash mute" aria-hidden="true"></i></button>
        </li>
    </ul>
</div>
</div>
</body>

</html>

<script type="text/javascript">

    //var socket = io.connect('http://localhost:3330');
//var socket = io.connect('http://35.164.220.7:3330');
//var socket = io.connect('https://vetx.herokuapp.com');
//var socket = io.connect('https://vetxb2c.herokuapp.com'); 
var socket = io.connect('https://www.vetxapp.com');

$.urlParam = function(name){
    var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
    return results[1] || 0;
}

var petId=$.urlParam('p');
var clinicId=$.urlParam('q');
var callUserId=$.urlParam('r');
var doctorId=$.urlParam('s');

var callInfo={"petId":petId,"clinicId":clinicId,"callUserId":callUserId,"doctorId":doctorId};


socket.on("userCallEndStatusInfo_"+callUserId, function(info) {

    alert("Call ended. Thanks for your call!");

    socket.emit('callEndStatus',callInfo, function(data){

    });
    window.close();

});


</script>
<!-- IE needs 512+ bytes: http://blogs.msdn.com/b/ieinternals/archive/2010/08/19/http-error-pages-in-internet-explorer.aspx -->
